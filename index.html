<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pura AI Chat - Vanguardia</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="/_sdk/element_sdk.js"></script>
    <style>@view-transition { navigation: auto; }</style>
    <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
</head>
<body>
    <div class="app-container">
        <div class="top-bar">
            <div class="top-bar-left">
                <div class="menu-icon nav-btn" id="menuButton" data-target="homePage">
                    <i class="fas fa-bars"></i>
                </div>
                <button class="plus-button">
                    <i class="fas fa-crown"></i> Obtener Plus
                </button>
            </div>
            <div class="top-bar-right">
                <div class="icon-button nav-btn" title="Ir a Home" data-target="homePage">
                    <i class="fas fa-home"></i>
                </div>
                <div class="profile-avatar-sm nav-btn" id="profileButton" data-target="settingsScreen">
                    A
                </div>
            </div>
        </div>

        <div id="homePage" class="page main-content">
            <div class="welcome-section">
                <h1 class="main-question" id="mainQuestion">¿En qué puedo ayudarte hoy?</h1>
                <div class="action-buttons">
                    <div class="action-card nav-btn" data-target="chatPage"> <div class="action-card-icon">
                            <i class="fas fa-paint-brush"></i>
                        </div>
                        <div class="action-card-text" id="actionButton1">
                            Generar una **Imagen** a partir de texto
                        </div>
                    </div>
                    <div class="action-card nav-btn" data-target="chatPage">
                        <div class="action-card-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="action-card-text" id="actionButton2">
                            Crear un **Plan** estratégico o itinerario
                        </div>
                    </div>
                    <div class="action-card nav-btn" data-target="chatPage">
                        <div class="action-card-icon">
                            <i class="fas fa-code"></i>
                        </div>
                        <div class="action-card-text" id="actionButton3">
                            **Generar Código** para mi proyecto web
                        </div>
                    </div>
                    <div class="action-card nav-btn" data-target="chatPage">
                        <div class="action-card-icon">
                            <i class="fas fa-feather-alt"></i>
                        </div>
                        <div class="action-card-text" id="actionButton4">
                            **Escribir Texto** creativo o profesional
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="chatPage" class="page" style="display:none">
            <div id="chatBox">
                <div class="msg" style="align-self: flex-start; background: var(--color-surface-card); color: var(--color-text-primary);">
                    ¡Hola Angel! Soy Pura AI, tu asistente avanzado. ¿Cómo puedo iniciar nuestra sesión hoy?
                </div>
            </div>
            
            <div class="input-bar">
                <div class="input-container">
                    <div class="input-icon" title="Adjuntar archivo">
                        <i class="fas fa-paperclip"></i>
                    </div>
                    <input id="msgInput" type="text" placeholder="Escribe tu mensaje aquí..." aria-label="Input de mensaje">
                    <button id="sendBtn">
                         <i class="fas fa-arrow-up"></i> Enviar
                    </button>
                </div>
            </div>
        </div>
        
        <div id="settingsScreen" class="page" style="display:none">
            <div class="settings-header">
                <div class="back-button" id="backButton" title="Volver">
                    <i class="fas fa-arrow-left"></i>
                </div>
                <div class="settings-title" id="settingsTitle">
                    Configuración de Cuenta
                </div>
            </div>
            <div class="settings-content">
                 <div class="settings-section profile-section">
                    <div class="profile-avatar-lg" style="background: linear-gradient(135deg, #9333ea, #ec4899);">A</div>
                    <div class="profile-info">
                        <div class="profile-name">Angel !</div>
                        <div class="profile-handle">@angxlaxz</div>
                    </div>
                    <button class="edit-profile-button" id="editProfileButton">
                        <i class="fas fa-user-edit"></i> Editar perfil
                    </button>
                </div>
                <div class="settings-section">
                    <div class="section-title">Suscripción</div>
                    <div class="settings-list">
                       <div class="settings-item" style="padding: 0; background: none; cursor: default;">
                            <button class="upgrade-button" id="upgradeButton">
                                <i class="fas fa-gem"></i> Mejorar a Plus
                            </button>
                       </div>
                    </div>
                </div>
                <button class="logout-button" id="logoutButton">
                    <i class="fas fa-sign-out-alt"></i> Cerrar sesión
                </button>
            </div>
        </div>
        
        <div class="overlay" id="overlay"></div>

        <div class="side-panel" id="sidePanel">
            <div class="side-panel-header">
                <input type="text" class="search-bar" placeholder="Buscar chats o temas...">
            </div>
            <div class="side-panel-content">
                <div class="menu-section">
                    <div class="menu-item nav-btn" data-target="chatPage" id="menuNewChat">
                        <div class="menu-item-icon"><i class="fas fa-plus-circle"></i></div>
                        <div class="menu-item-text">Nuevo Chat</div>
                    </div>
                </div>
                <div class="menu-section">
                    <div class="section-title">Chats Recientes</div>
                    <div class="chat-list">
                        <div class="chat-item nav-btn" data-target="chatPage">
                            <i class="far fa-comment-dots" style="color: var(--color-text-secondary); font-size: 16px;"></i>
                            <div class="chat-title">Diseño de Interfaz Avanzado</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="side-panel-footer nav-btn" id="accountButton" data-target="settingsScreen">
                <div class="user-avatar" style="background: linear-gradient(135deg, #9333ea, #ec4899);">A</div>
                <div class="user-name">Angel !</div>
                <div class="footer-settings-icon"><i class="fas fa-cog"></i></div>
            </div>
        </div>

    </div>
    
    <script>
        // ==========================================================
        // Lógica de Navegación de Páginas (Requisito 3)
        // ==========================================================
        const pages = document.querySelectorAll(".page");
        const navButtons = document.querySelectorAll(".nav-btn");
        const sidePanel = document.getElementById('sidePanel');
        const overlay = document.getElementById('overlay');
        const settingsScreen = document.getElementById('settingsScreen');
        const backButton = document.getElementById('backButton');

        function closeSidePanelAndOverlay() {
             sidePanel.classList.remove('open');
             overlay.classList.remove('visible');
        }
        
        // Asignar navegación a botones y tarjetas
        navButtons.forEach(btn => {
          btn.addEventListener("click", () => {
            const targetId = btn.dataset.target;

            // Lógica para cerrar paneles al navegar
            if (targetId !== 'sidePanel' && sidePanel.classList.contains('open')) {
                closeSidePanelAndOverlay();
            }
            if (targetId !== 'settingsScreen' && settingsScreen.classList.contains('open')) {
                settingsScreen.classList.remove('open');
                overlay.classList.remove('visible');
            }

            // Lógica de navegación de páginas (solo si no es el SidePanel o Settings)
            if (targetId === 'homePage' || targetId === 'chatPage') {
                pages.forEach(p => {
                    p.style.display = "none";
                });
                document.getElementById(targetId).style.display = "flex"; // Usamos 'flex' para las páginas
            }
            
            // Lógica para abrir SidePanel
            if (btn.id === 'menuButton' && targetId === 'homePage') {
                sidePanel.classList.add('open');
                overlay.classList.add('visible');
            }
            
            // Lógica para abrir Settings
             if (targetId === 'settingsScreen') {
                settingsScreen.classList.add('open');
                overlay.classList.add('visible');
            }
          });
        });
        
        // Cerrar paneles con overlay
        overlay.addEventListener('click', () => {
             closeSidePanelAndOverlay();
             settingsScreen.classList.remove('open');
        });
        
        // Botón de atrás en Configuración
        backButton.addEventListener('click', () => {
             settingsScreen.classList.remove('open');
             overlay.classList.remove('visible');
        });
        
        // ==========================================================
        // Lógica de Envío de Mensaje (Requisito 2)
        // ==========================================================
        document.getElementById("sendBtn").addEventListener("click", function() {
          const input = document.getElementById("msgInput");
          const chat = document.getElementById("chatBox");

          // Prevenir el envío si el campo está vacío o solo tiene espacios
          if(input.value.trim() === "") return;

          // Crear el mensaje (usuario)
          const msg = document.createElement("div");
          msg.classList.add("msg");
          msg.textContent = input.value;

          // Añadir mensaje al chat
          chat.appendChild(msg);
          
          // Limpiar y hacer scroll
          input.value = "";
          chat.scrollTop = chat.scrollHeight;
          
          // Opcional: Respuesta de la IA para simular
          setTimeout(() => {
              const aiMsg = document.createElement("div");
              aiMsg.classList.add("msg");
              aiMsg.textContent = "Mensaje recibido. Procesando tu solicitud de forma profesional...";
              
              // Estilo para la IA
              aiMsg.style.alignSelf = 'flex-start';
              aiMsg.style.background = 'var(--color-surface-card)';
              aiMsg.style.color = 'var(--color-text-primary)';
              
              chat.appendChild(aiMsg);
              chat.scrollTop = chat.scrollHeight;
          }, 800);
        });

        // Permitir envío con Enter en el campo de texto
        document.getElementById("msgInput").addEventListener("keypress", function(e) {
            if (e.key === 'Enter') {
                document.getElementById("sendBtn").click();
            }
        });
        
        // Llenar el input al hacer clic en las tarjetas de acción
        document.querySelectorAll('.action-card').forEach(card => {
            card.addEventListener('click', () => {
                const rawText = card.querySelector('.action-card-text').textContent;
                const text = rawText.replace(/\*\*/g, '').trim(); 
                document.getElementById('msgInput').value = text;
            });
        });

        // Mantener la lógica del SDK (sin cambios)
        const defaultConfig = { /* ... */ };
        async function onConfigChange(config) { /* ... */ }
        function mapToCapabilities(config) { /* ... */ return {}; }
        function mapToEditPanelValues(config) { /* ... */ return new Map(); }
        
        if (window.elementSdk) {
            window.elementSdk.init({ defaultConfig, onConfigChange, mapToCapabilities, mapToEditPanelValues });
        }
    </script>
</body>
</html>
